x = NULL,
title = title,
subtitle = "Monthly contribution to inflation, annualized. Yellow line is 2018-19 geometric mean.",
caption ="BLS, CPI, 2022 weights prior to 2023, seasonally adjusted. Author's calculation. Mike Konczal.") +
theme_esp() +
scale_fill_manual(values = esp_colors) +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = date_breaks) +
theme(axis.text.x = element_text(size=14), axis.text.y = element_text(size=19)) +
geom_line(aes(date,geometric_mean), color="darkred", size=1.4)
}
onion_chart2 <- function(cpi_data, start_date, title = NA){
date_breaks <- generate_dates(cpi_data$date, date_breaks_length)
three_categories <- cpi_data %>%
filter(date > start_date, item_name %in% c("Services less energy services", "Shelter", "Commodities less food and energy commodities")) %>%
mutate(item_name = str_replace_all(item_name, "Commodities less food and energy commodities", "Core_goods")) %>%
select(date, item_name, Wchange1a) %>%
pivot_wider(names_from = item_name, values_from = Wchange1a) %>%
mutate(`Rest of core services` = `Services less energy services` - `Shelter`) %>%
select(-`Services less energy services`) %>%
pivot_longer(c(Shelter, `Rest of core services`, Core_goods), names_to = "item_name", values_to = "Wchange1a") %>%
mutate(item_name = str_replace_all(item_name, "Core_goods", "Core goods")) %>%
mutate(item_name = factor(item_name, levels = c("Core goods", "Shelter", "Rest of core services"))) %>%
mutate(num_label = round(100 * Wchange1a, 1)) %>%
mutate(num_label = ifelse(abs(num_label) < 0.16, NA, num_label))
three_categories %>%
ggplot(aes(x = date, y = Wchange1a, fill=item_name)) +
geom_bar(stat = 'identity', size=0) +
theme(legend.position = "bottom", legend.title = element_blank()) +
facet_grid(~item_name) +
labs(y = NULL,
x = NULL,
title = title,
subtitle = "Monthly contribution to inflation, annualized.",
caption ="BLS, CPI, 2022 weights prior to 2023, seasonally adjusted. Author's calculation. Mike Konczal") +
theme_esp() +
scale_fill_brewer(palette="RdPu", name = "item_name") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three_categories) +
theme(axis.text.x = element_text(size=14), axis.text.y = element_text(size=19))
}
#####
subtract_cpi_items <- function(cpi, start_date, base_item, subtract_array,
add_on_array = NA, rest_name_variable = "Rest of Variable"){
c1 <- cpi %>% filter(date >= start_date) %>%
filter(item_name %in% subtract_array) %>%
select(date, Wchange1a) %>%
group_by(date) %>%
summarize(total_rest = sum(Wchange1a))
c2 <- cpi %>%
filter(item_name == base_item) %>%
select(date, Wchange1a) %>%
left_join(c1, by="date") %>%
mutate(Wchange1a = Wchange1a - total_rest) %>%
mutate(item_name = rest_name_variable) %>%
select(date, item_name, Wchange1a)
if(!is.na(add_on_array))
c3 <- cpi %>%
filter(item_name %in% add_on_array) %>%
select(date, item_name, Wchange1a)
c <- cpi %>% filter(date >= start_date) %>%
filter(item_name %in% subtract_array) %>%
select(date, item_name, Wchange1a) %>%
rbind(c2)
if(!is.na(add_on_array))
c <- c %>% rbind(c3)
c <- c %>%
arrange(date) %>%
filter(date >= start_date) %>%
mutate(num_label = round(100*Wchange1a, 1)) %>% mutate(num_label = ifelse(abs(num_label) < 0.16, NA, num_label))
return(c)
}
draw_ridgeline <- function(cpi, item_list, top_cut = 0.85, bottom_cut = 0.15, title = NA) {
median_data <- cpi %>%
filter(item_name %in% item_list | item_name == "Owners' equivalent rent of residences") %>%
filter(!is.na(date)) %>%
arrange(date) %>%
group_by(date) %>%
mutate(normalized = sum(weight)) %>%
mutate(weightN = weight / normalized) %>%
arrange(Pchange3) %>%
mutate(cumsum = cumsum(weight) / 100) %>%
mutate(cumsumN = cumsum(weightN)) %>%
ungroup() %>%
mutate(Pchange3a = (1 + Pchange3)^4 - 1)
quarters_backwards <- (month(max(cpi$date)) + c(0, 3, 6, 9) - 1) %% 12 + 1
# THIS IS THE GRAPHIC - 30 percent-trimmed distribution
median_data %>%
mutate(dateF = as.factor(date)) %>%
filter(cumsumN <= top_cut & cumsum >= bottom_cut) %>%
filter(date >= "2017-06-01") %>%
filter(date != "2020-06-01") %>%
filter(month(date) %in% quarters_backwards) %>%
mutate(monthC = format(date, "%B, %Y")) %>%
mutate(monthC = fct_reorder(monthC, date)) %>%
mutate(monthCR = fct_rev(monthC)) %>%
ggplot(aes(x = Pchange3a, y = monthCR, fill = stat(x))) +
geom_density_ridges_gradient() +
scale_fill_viridis(option = "H") +
theme_ridges() +
theme_esp() +
theme(legend.position = "none") +
scale_x_continuous(labels = percent) +
labs(
title = title,
subtitle = "Distribution of the Cleveland Fed's Median/Trimmed-Mean CPI price basket, 3-month change annualized, with components\nwhose expenditure weights fall above/below the 85/15th percentile of price changes removed.",
x = "Three Month Percent Change", y = "", caption = "OER is treated as one value, instead of broken out by region and manually seasonally adjusted as per Cleveland Fed's methodology.Some 2020s removed as negative outlier. Mike Konczal"
) +
theme(
plot.title.position = "plot", legend.position = "none", legend.title = element_blank(),
plot.title = element_text(size = 25, margin = margin(0, 0, 5, 0)),
plot.subtitle = element_text(size = 15),
plot.caption = element_text(size = 10, face = "italic"),
axis.text.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 12)
)
}
unadjusted_analysis <- function(cpi_data, years_array, title = NA) {
cpi_data %>%
filter(series_id == "CUUR0000SA0L1E", period != "M13") %>%
select(date, value) %>%
mutate(month = month(date), year = as.factor(year(date))) %>%
mutate(pchange1 = value / lag(value, 1) - 1) %>%
filter(year(date) %in% years_array) %>%
ggplot(aes(month, pchange1, color = year)) +
geom_line(size = 1.2) +
theme_esp() +
scale_x_continuous(breaks = 1:12, labels = month.abb) +
scale_y_continuous(labels = percent) +
geom_text_repel(aes(label = year),
size = 7,
data = . %>% group_by(year) %>% filter(month == 3) %>% ungroup()
) +
labs(
title = title,
subtitle = "Seasonally unadjusted values for core CPI inflation, 1-month percent change, not annualized.",
caption = "Inspired by Paul Romer's blog. Mike Konczal"
)
}
##### SET UP SOME THINGS #####
cpi_versus_pce <- function(cpi_df, compare_length = 6, start_graphic = "2014-01-01", breaks_value = 6, title="",
legend.position.c = c(0.5,0.60), colors = c("6-Month Core CPI Change" = "#BA68C8", "6-Month Core PCE Change" = "#4F97D7"),
label_length = 6,
column_alpha=0.2) {
getSymbols("PCEPILFE", src = "FRED")
# Convert the data to a tibble
pce_data <- data.frame(date = index(get("PCEPILFE")), Value = coredata(get("PCEPILFE"))) %>%
as_tibble() %>% rename(core_pce6A = PCEPILFE) %>%
mutate(core_pce6A = core_pce6A/lag(core_pce6A, 6),
core_pce6A = core_pce6A^2 - 1)
breaks_value <- generate_dates(cpi_df$date, breaks_value)
# Data manipulation
cpi_df <- make_three_six_data(cpi_df, "All items less food and energy", 6) %>% filter(time_length == "6-Month Change") %>% select(date, core_cpi6A = change) %>%
left_join(pce_data, by="date") %>%
pivot_longer(core_cpi6A:core_pce6A, names_to = "time_length", values_to = "change") %>%
group_by(time_length) %>%
mutate(
last_value = ifelse(date==max(date),change,NA),
last_valueL = ifelse(!is.na(last_value), paste0(format(date, '%b, %Y'), "\n", label_percent(accuracy=0.1)(round(last_value,3))), NA)) %>%
ungroup() %>%
mutate(
time_length = case_when(
time_length == "core_cpi6A" ~ "6-Month Core CPI Change",
time_length == "core_pce6A" ~ "6-Month Core PCE Change",
TRUE ~ time_length
)
)
inf_diff <- cpi_df %>% select(-last_value, -last_valueL) %>%
pivot_wider(names_from = time_length, values_from = change) %>%
clean_names() %>%
mutate(inf_diff_1 = x6_month_core_cpi_change - x6_month_core_pce_change) %>%
select(date, inf_diff_1) %>%
mutate(time_length = "6-Month Core CPI Change")
# Plot
p <- cpi_df %>%
filter(date >= start_graphic) %>%
left_join(inf_diff, by=c("date","time_length")) %>%
ggplot(aes(date, change, color=time_length,label=last_valueL)) +
geom_line(size=1.6) +
geom_text_repel(
show.legend=FALSE, nudge_x = 85, min.segment.length = Inf
) +
geom_col(aes(date, inf_diff_1), alpha=column_alpha, size=0, show.legend = FALSE) +
labs(
x="", y="",
title=title,
subtitle = "Core CPI inflation vs core PCE inflation, 6-month change, annualized. Bars measure difference between them.",
caption = "CPI: BLS, All items less food and energy. PCE: BEA, PCE excluding food and energy, Author's calculations. Mike Konczal."
) +
theme_esp() +
scale_color_manual(values=colors) +
scale_y_continuous(labels = scales::percent) +
scale_x_date(date_labels = "%b\n%Y", breaks=breaks_value) +
theme(
panel.grid.major.y = element_line(size=0.5),
legend.position = legend.position.c,
legend.text = element_text(size=15)
)
return(p)
}
#Graphic 1: Overview
core_3_6_title <- "Core Inflation Continues to Pick Back Up in July"
g <- three_six_graphic(cpi, "All items less food and energy", "2018-01-01", "2020-01-01", "2022-01-01",
title = core_3_6_title, include_3_6 = TRUE, column_alpha = 0.2,
subtitle = "All items less food and energy, seasonally adjusted, boxes are one-month change annualized.",
colors = c("3-Month Change" = "#2c3254", "6-Month Change" = "#ff8361")) +
scale_fill_brewer(palette = "Paired") +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/g1_core_inflation.png", dpi="retina", width = 12, height=6.75, units = "in")
# Graphic 4: Core Services
subtract_array <- c("Shelter", "Medical care services", "Transportation services")
services_breakdown <- subtract_cpi_items(cpi, "2018-01-01", "Services less energy services",
subtract_array = subtract_array, add_on_array = "Food away from home")
stacked_graphic(services_breakdown, unique(services_breakdown$item_name), start_date = "2022-01-01",
title = "Transportation Services Drive Increase in July", date_breaks_length = 12, add_labels = TRUE, palette= "RdPu", legend.position = c(0.85,0.9)) +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/g4_services_breakdown.png", dpi="retina", width = 12, height=6.75, units = "in")
# transportation services breakdown
subtract_array <- c("Car and truck rental", "Motor vehicle insurance", "Motor vehicle fees", "Public transportation","Motor vehicle maintenance and repair")
services_breakdown <- subtract_cpi_items(cpi, "2018-01-01", "Transportation services",
subtract_array = subtract_array)
stacked_graphic(services_breakdown, unique(services_breakdown$item_name), start_date = "2022-01-01",
title = "What's Happening in Transportation Services?", date_breaks_length = 12, add_labels = TRUE, palette= "RdPu", legend.position = c(0.6,0.9))
ggsave("graphics/g_ts.png", dpi="retina", width = 12, height=6.75, units = "in")
all %>%
mutate(last_value = ifelse(date==max(date),total_3,NA),
month3 = total_3 + lag(total_3, 1) + lag(total_3, 2),
month3 = month3/3) %>%
filter(date >= "2018-01-01") %>%
ungroup() %>%
ggplot(aes(date, y = total_3, label=label_percent()(last_value))) + geom_line(size=1) +
labs(y = NULL,
x = NULL,
title = "Percent of Items With 3% Price Growth Has Increased in Recent Months",
subtitle = "Percent of 140 CPI items (82 in core) having at least 3 percent monthly price increases, annualized.",
caption ="BLS, CPI, only seasonally adjusted items included. Author's calculation. Mike Konczal.") +
theme(panel.grid.major.y = element_line(size=0.5)) +
theme(plot.title.position = "plot") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three) +
geom_text(show.legend=FALSE, nudge_x = 125) +
theme(legend.position = c(0.35,0.8)) +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/three_percent_growth_all_items.png", dpi="retina", width = 12, height=6.75, units = "in")
cpi %>% filter(item_name %in% core$item_name, !is.na(Pchange1)) %>% mutate(p3 = (Pchange1a > 0.03)) %>%
group_by(date) %>%
summarize(total_3 = sum(p3)/n()) %>% ungroup() %>% ungroup() %>% mutate(type = "Core items") %>%
rbind(all) %>%
group_by(type) %>%
mutate(last_value = ifelse(date==max(date),total_3,NA)) %>%
filter(date >= "2018-01-01") %>%
ungroup() %>%
ggplot(aes(date, total_3, color=type, label=label_percent()(last_value))) + geom_line(size=1) +
labs(y = NULL,
x = NULL,
title = "Percent of Items With 3% Price Growth Has Decreased From High Levels",
subtitle = "Percent of 140 CPI items (82 in core) having at least 3 percent monthly price increases, annualized.",
caption ="BLS, CPI, only seasonally adjusted items included. Author's calculation. Mike Konczal, Roosevelt Institute") +
theme(panel.grid.major.y = element_line(size=0.5)) +
theme(plot.title.position = "plot") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three) +
geom_text(show.legend=FALSE, nudge_x = 125) +
theme(legend.position = c(0.35,0.8)) +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/three_percent_growth_both.png", dpi="retina", width = 12, height=6.75, units = "in")
cpi %>% filter(item_name %in% core$item_name, !is.na(Pchange1)) %>% mutate(p3 = (Pchange1a > 0.03)) %>%
group_by(date) %>%
summarize(total_3 = sum(p3)/n()) %>% ungroup() %>% ungroup() %>% mutate(type = "Core items") %>%
#rbind(all) %>%
group_by(type) %>%
mutate(last_value = ifelse(date==max(date),total_3,NA)) %>%
filter(date >= "2018-01-01") %>%
ungroup() %>%
ggplot(aes(date, total_3, label=label_percent()(last_value))) + geom_line(size=1) +
labs(y = NULL,
x = NULL,
title = "Percent of Items With 3% Price Growth Has Decreased From High Levels",
subtitle = "Percent of 140 CPI items (82 in core) having at least 3 percent monthly price increases, annualized.",
caption ="BLS, CPI, only seasonally adjusted items included. Author's calculation. Mike Konczal, Roosevelt Institute") +
theme(panel.grid.major.y = element_line(size=0.5)) +
theme(plot.title.position = "plot") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three) +
geom_text(show.legend=FALSE, nudge_x = 125) +
theme(legend.position = c(0.35,0.8)) +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
cpi %>% filter(item_name %in% core$item_name, !is.na(Pchange1)) %>% mutate(p3 = (Pchange1a > 0.03)) %>%
group_by(date) %>%
summarize(total_3 = sum(p3)/n()) %>% ungroup() %>% ungroup() %>% mutate(type = "Core items") %>%
#rbind(all) %>%
group_by(type) %>%
mutate(last_value = ifelse(date==max(date),total_3,NA)) %>%
filter(date >= "2018-01-01") %>%
ungroup() %>%
ggplot(aes(date, total_3, label=label_percent()(last_value))) + geom_line(size=1) +
labs(y = NULL,
x = NULL,
title = "Percent of Items With 3% Price Growth Has Decreased From High Levels",
subtitle = "Percent of 82 in core having at least 3 percent monthly price increases, annualized.",
caption ="BLS, CPI, only seasonally adjusted items included. Author's calculation. Mike Konczal, Roosevelt Institute") +
theme(panel.grid.major.y = element_line(size=0.5)) +
theme(plot.title.position = "plot") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three) +
geom_text(show.legend=FALSE, nudge_x = 125) +
theme(legend.position = c(0.35,0.8)) +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/three_percent_growth_both.png", dpi="retina", width = 12, height=6.75, units = "in")
cpi %>% filter(item_name %in% core$item_name, !is.na(Pchange1)) %>% mutate(p3 = (Pchange1a > 0.03)) %>%
group_by(date) %>%
summarize(total_3 = sum(p3)/n()) %>% ungroup() %>% ungroup() %>% mutate(type = "Core items") %>%
#rbind(all) %>%
group_by(type) %>%
mutate(last_value = ifelse(date==max(date),total_3,NA)) %>%
filter(date >= "2018-01-01") %>%
ungroup() %>%
ggplot(aes(date, total_3, label=label_percent()(last_value))) + geom_line(size=1) +
labs(y = NULL,
x = NULL,
title = "Percent of Items With 3% Price Growth Has Decreased From High Levels",
subtitle = "Percent of 82 in core having at least 3 percent monthly price increases, annualized.",
caption ="BLS, CPI, only seasonally adjusted items included. Author's calculation. Mike Konczal, Roosevelt Institute") +
theme(panel.grid.major.y = element_line(size=0.5)) +
theme(plot.title.position = "plot") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three) +
geom_text(show.legend=FALSE, nudge_x = 75) +
theme(legend.position = c(0.35,0.8)) +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/three_percent_growth_both.png", dpi="retina", width = 12, height=6.75, units = "in")
cpi %>% filter(item_name %in% core$item_name, !is.na(Pchange1)) %>% mutate(p3 = (Pchange1a > 0.03)) %>%
group_by(date) %>%
summarize(total_3 = sum(p3)/n()) %>% ungroup() %>% ungroup() %>% mutate(type = "Core items") %>%
#rbind(all) %>%
group_by(type) %>%
mutate(last_value = ifelse(date==max(date),total_3,NA)) %>%
filter(date >= "2018-01-01") %>%
ungroup() %>%
ggplot(aes(date, total_3, label=label_percent()(last_value))) + geom_line(size=1) +
labs(y = NULL,
x = NULL,
title = "Percent of Items With 3% Price Growth is Increasing",
subtitle = "Percent of 82 in core having at least 3 percent monthly price increases, annualized.",
caption ="BLS, CPI, only seasonally adjusted items included. Author's calculation. Mike Konczal, Roosevelt Institute") +
theme(panel.grid.major.y = element_line(size=0.5)) +
theme(plot.title.position = "plot") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three) +
geom_text(show.legend=FALSE, nudge_x = 75) +
theme(legend.position = c(0.35,0.8)) +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/three_percent_growth_both.png", dpi="retina", width = 12, height=6.75, units = "in")
cpi %>% filter(item_name %in% core$item_name, !is.na(Pchange1)) %>% mutate(p3 = (Pchange1a > 0.03)) %>%
group_by(date) %>%
summarize(total_3 = sum(p3)/n()) %>% ungroup() %>% ungroup() %>% mutate(type = "Core items") %>%
#rbind(all) %>%
group_by(type) %>%
mutate(last_value = ifelse(date==max(date),total_3,NA)) %>%
filter(date >= "2018-01-01") %>%
ungroup() %>%
ggplot(aes(date, total_3, label=label_percent()(last_value))) + geom_line(size=1) +
labs(y = NULL,
x = NULL,
title = "Percent of Items With 3% Price Growth is Increasing",
subtitle = "Percent of 82 item in core basket having at least 3 percent monthly price increases, annualized.",
caption ="BLS, CPI, only seasonally adjusted items included. Author's calculation. Mike Konczal, Roosevelt Institute") +
theme(panel.grid.major.y = element_line(size=0.5)) +
theme(plot.title.position = "plot") +
scale_y_continuous(labels = percent) +
scale_x_date(date_labels = "%b\n%Y", breaks = MI_dates_three) +
geom_text(show.legend=FALSE, nudge_x = 75) +
theme(legend.position = c(0.35,0.8)) +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/three_percent_growth_both.png", dpi="retina", width = 12, height=6.75, units = "in")
# Plot only top n; order facets by gap
cpi_goods %>%
filter(year(date) >= 2023,
goods_level == 1) %>%
ggplot(aes(date, value)) +
geom_line(color = esp_navy, size = 1.2) +
geom_line(aes(y = trendline), linetype = "dashed", color = esp_navy, size = 1) +
facet_wrap(~ item_name, scales = "free_y") +
labs(subtitle = "Top 10 items by (latest value − trendline)") +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/t2_worst_12_price_increases.png", dpi="retina", width = 12, height=6.75, units = "in")
# Graphic 1 - Known Targets ----
trump_targets <- c(
"Appliances",
"Transportation commodities less motor fuel",
"Apparel",
"Household furnishings and supplies",
"Laundry equipment"
)
# Plot only top n; order facets by gap
cpi_goods %>%
filter(year(date) >= 2023,
item_name %in% trump_targets) %>%
ggplot(aes(date, value)) +
geom_line(color = esp_navy, size = 1.2) +
geom_line(aes(y = trendline), linetype = "dashed", color = esp_navy, size = 1) +
facet_wrap(~ item_name, scales = "free_y") +
labs(subtitle = "Top 10 items by (latest value − trendline)") +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/t2_worst_12_price_increases.png", dpi="retina", width = 12, height=6.75, units = "in")
# Plot only top n; order facets by gap
cpi_goods %>%
semi_join(topn_items, by = "item_name") %>%
left_join(select(topn_items, item_name, gap), by = "item_name") %>%
mutate(item_name = fct_reorder(item_name, gap, .desc = TRUE)) %>%
filter(year(date) >= 2023) %>%
ggplot(aes(date, value)) +
geom_line(color = esp_navy, size = 1.2) +
geom_line(aes(y = trendline), linetype = "dashed", color = esp_navy, size = 1) +
facet_wrap(~ item_name, scales = "free_y") +
labs(subtitle = "Top 10 items by (latest value − trendline)") +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/t2_worst_12_price_increases.png", dpi="retina", width = 12, height=6.75, units = "in")
# Graphic 1 - Known Targets ----
trump_targets <- c(
"Appliances",
"Transportation commodities less motor fuel",
"Apparel",
"Household furnishings and supplies",
"Laundry equipment",
"Audio equipment"
)
# Plot only top n; order facets by gap
cpi_goods %>%
filter(year(date) >= 2023,
item_name %in% trump_targets) %>%
ggplot(aes(date, value)) +
geom_line(color = esp_navy, size = 1.2) +
geom_line(aes(y = trendline), linetype = "dashed", color = esp_navy, size = 1) +
facet_wrap(~ item_name, scales = "free_y") +
labs(title = "The Likely Tariff Targets Are Seeing Large Price Increases",
subtitle = "CPI. Log-linear trendline from Jan 2023 to Dec 2024.") +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/t2_worst_12_price_increases.png", dpi="retina", width = 12, height=6.75, units = "in")
# Plot only top n; order facets by gap
cpi_goods %>%
semi_join(topn_items, by = "item_name") %>%
left_join(select(topn_items, item_name, gap), by = "item_name") %>%
mutate(item_name = fct_reorder(item_name, gap, .desc = TRUE)) %>%
filter(year(date) >= 2023) %>%
ggplot(aes(date, value)) +
geom_line(color = esp_navy, size = 1.2) +
geom_line(aes(y = trendline), linetype = "dashed", color = esp_navy, size = 1) +
facet_wrap(~ item_name, scales = "free_y") +
labs(subtitle = "Top 10 items by (latest value − trendline)") +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/t2_worst_12_price_increases.png", dpi="retina", width = 12, height=6.75, units = "in")
cpi_goods %>%
semi_join(topn_items, by = "item_name") %>%
left_join(select(topn_items, item_name, gap), by = "item_name")
# Plot only top n; order facets by gap
cpi_goods %>%
semi_join(topn_items, by = "item_name") %>%
left_join(select(topn_items, item_name, gap), by = "item_name") %>%
mutate(item_name = fct_reorder(item_name, gap, .desc = TRUE)) %>%
filter(year(date) >= 2023) %>%
ggplot(aes(date, value)) +
geom_line(color = esp_navy, size = 1.2) +
geom_line(aes(y = trendline), linetype = "dashed", color = esp_navy, size = 1) +
facet_wrap(~ item_name, scales = "free_y") +
labs(title = "12 Commodity Items (All Levels) Where Prices Are Higher Than Their Trendline") +
theme_esp() +
theme(
panel.grid.major.y = element_line(color = "grey80"),
)
ggsave("graphics/t2_worst_12_price_increases.png", dpi="retina", width = 12, height=6.75, units = "in")
# Graph 3: The major categories -----
